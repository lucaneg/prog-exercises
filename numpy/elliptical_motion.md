# Elliptical motion

An elliptical motion on a plane can be described using separate equations for the x and y components of both position and velocity.

Let's denote:

* **omega** as the angular velocity (angular frequency) of the object's motion
* **a** as the semi-major axis of the ellipse, that is, half of the longest diameter
* **b** as the semi-minor axis of the ellipse, that is, half of the shortest diameter

The equations for position in an elliptical orbit are given by:

* x(t) = **a** cos(**omega** t)
* y(t) = **b** sin(**omega** t)

In an elliptical orbit, the speed of the object is not constant but varies as it moves along its path. The speed is maximum at the perigee and minimum at the apogee. The speed of the object at any point along its path in the elliptical orbit can be found using the equation:

* v(t)=sqrt(v\\_x(t)\\*\\*2 + v\\_y(t)\\*\\*2)

where:

* v\\_x(t) is the x-component of the speed
* v\\_y(t) is the y-component of the speed

The x and y components of the velocity can be obtained by taking the time derivatives of the position equations:

* v\\_x(t) = −**a** **omega** sin⁡(**omega** t)
* v\\_y(t) =  **b** **omega** cos(**omega** t)

These equations describe the variation of speed and the components of velocity in an elliptical orbit as a function of time.

In this exercise, you must write the following functions:

* function `sample_time_interval` that, given `t_max` (an integer value in seconds) and `samples_per_second`, returns a numpy array containing the samples of the time variable `t`, in the interval `[0, t_max]`, generating `samples_per_second` samples **each second**
* function `x_coord` that, given `a`, `b`, `omega`, and `samples` (containing the numpy array generated by `sample_time_interval`), returns the values of the x coordinate on each sample by using x(t)
* function `y_coord` that, given `a`, `b`, `omega`, and `samples` (containing the numpy array generated by `sample_time_interval`), returns the values of the y coordinate on each sample by using y(t)
* function `x_speed` that, given `a`, `b`, `omega`, and `samples` (containing the numpy array generated by `sample_time_interval`), returns the values of the speed along the x axis on each sample by using v\\_x(t)
* function `y_speed` that, given `a`, `b`, `omega`, and `samples` (containing the numpy array generated by `sample_time_interval`), returns the values of the speed along the y axis on each sample by using v\\_y(t)
* function `speed` that, given `v_x` and  `v_y` containing the results of `x_speed` and `y_speed`, returns the values of the cumulative speed on each sample by using v(t)

Finally, you must find what are the stationary points (i.e., local maxima and local minima) of each function by empirically computing their derivatives.  Write a function `stationary_points` that, given a numpy array `samples` containing the time samples and a numpy array `values` containing the values of one of the functions:

1. computes the difference `delta_v` between each value in `values` and its predecessor
2. computes the difference `delta_t` between each value in `samples` and its predecessor
3. computes the local derivative of each value in `values` as `delta_v/delta_t`
4. finds the indexes of the elements in the derivatives array where the derivative is positive or zero (let's call the set of these indexes *S*), and for each such index *k*:
5. checks the index *k-1* and *k+1* are contained into *S*
6. if *k-1* in *S*, but *k+1* not in *S*, then *k* is the best approximation of a stationary point: you must store the *k*-th element of `samples` and the *k*-th element of `values` in a list of stationary times and stationary values (**two lists**), respectively
7. repeats step 4 for negative derivatives
8. returns **two numpy arrays**, with the first containing all of the stationary elements in `samples` and the second containing all of the stationary elements in `values`

**Suggestion:** use loops freely to calculate the stationary elements!

## Template

```py
import numpy as np
def print_array(arr):
  '''Utility function to print formatted arrays, will be used during evaluation'''
  print(' '.join(f'{e:> #8.3f}' for e in arr))

"if __name__ == '__main__':
  a = float(input())
  b = float(input())
  omega = float(input())
  t_max = int(input())
  samples_per_second = int(input())
  kind = input()

  samples = sample_time_interval(t_max, samples_per_second)
  x = x_coord(a, b, omega, samples)
  y = y_coord(a, b, omega, samples)
  v_x = x_speed(a, b, omega, samples)
  v_y = y_speed(a, b, omega, samples)
  v = speed(v_x, v_y)

  print_array(np.fabs(samples[:10]))
  print_array(np.fabs(x[:10]))
  print_array(np.fabs(y[:10]))
  print_array(np.fabs(v_x[:10]))
  print_array(np.fabs(v_y[:10]))
  print_array(np.fabs(v[:10]))

  if kind == 'full':
    stationary_x_times, stationary_x = stationary_points(samples, x)
    stationary_y_times, stationary_y = stationary_points(samples, y)
    stationary_v_x_times, stationary_v_x = stationary_points(samples, v_x)
    stationary_v_y_times, stationary_v_y = stationary_points(samples, v_y)
    stationary_v_times, stationary_v = stationary_points(samples, v)

    print_array(np.fabs(stationary_x_times[:10]))
    print_array(np.fabs(stationary_x[:10]))
    print_array(np.fabs(stationary_y_times[:10]))
    print_array(np.fabs(stationary_y[:10]))
    print_array(np.fabs(stationary_v_x_times[:10]))
    print_array(np.fabs(stationary_v_x[:10]))
    print_array(np.fabs(stationary_v_y_times[:10]))
    print_array(np.fabs(stationary_v_y[:10]))
    print_array(np.fabs(stationary_v_times[:10]))
    print_array(np.fabs(stationary_v[:10]))
```

## Testcases

### 1

IN:
```
500
300
3
10
100
full
```

OUT:
```
   0.000    0.010    0.020    0.030    0.040    0.050    0.060    0.070    0.080    0.090
 500.000  499.775  499.098  497.972  496.397  494.374  491.906  488.994  485.640  481.849
   0.000    9.008   18.007   26.990   35.949   44.876   53.762   62.600   71.381   80.098
   0.000   45.038   90.036  134.952  179.747  224.380  268.810  312.998  356.904  400.488
 900.000  899.594  898.377  896.350  893.515  889.874  885.430  880.188  874.153  867.329
 900.000  900.721  902.878  906.452  911.415  917.726  925.335  934.184  944.205  955.327
   2.092    4.184    6.286    8.378   10.000    1.051    3.143    5.235    7.327    9.429
 499.988  499.952  499.978  499.999   77.126  499.967  499.995  499.999  499.979  499.951
   0.521    2.623    4.715    6.807    8.899   10.000    1.572    3.664    5.756    7.858
 299.987  299.971  299.993  300.000  299.993  296.409  299.999  299.997  299.980  299.980
   1.572    3.664    5.756    7.858    9.950    0.521    2.623    4.715    6.807    8.899
 1499.996  1499.984  1499.901  1499.899  1499.983  1499.936  1499.855  1499.963  1500.000  1499.965
   2.092    4.184    6.286    8.378   10.000    1.051    3.143    5.235    7.327    9.429
 899.979  899.914  899.961  899.997  138.826  899.940  899.990  899.998  899.962  899.912
   0.521    1.572    2.623    3.664    4.715    5.756    6.807    7.858    8.899    9.950
 1499.959  1499.997  1499.907  1499.990  1499.977  1499.937  1500.000  1499.935  1499.978  1499.989
```

### 2

IN:
```
54.01061486537526
-74.76796665571183
6.026464914299694
43
309
partial
```

OUT:
```
   0.000    0.003    0.006    0.010    0.013    0.016    0.019    0.023    0.026    0.029
  54.011   54.000   53.970   53.918   53.846   53.754   53.641   53.508   53.354   53.181
   0.000    1.458    2.916    4.372    5.827    7.280    8.730   10.177   11.619   13.058
   0.000    6.348   12.694   19.035   25.369   31.693   38.005   44.302   50.583   56.844
 450.587  450.501  450.244  449.815  449.216  448.446  447.505  446.393  445.112  443.662
 450.587  450.546  450.423  450.218  449.932  449.564  449.115  448.586  447.977  447.289
```

### 3

IN:
```
-16.837626713301972
9.666010515885176
-6.483030927240945
18
343
partial
```

OUT:
```
   0.000    0.003    0.006    0.009    0.012    0.015    0.017    0.020    0.023    0.026
  16.838   16.835   16.826   16.811   16.790   16.762   16.729   16.690   16.645   16.595
   0.000    0.183    0.365    0.548    0.730    0.912    1.094    1.275    1.456    1.637
   0.000    2.063    4.126    6.187    8.246   10.302   12.355   14.403   16.445   18.482
  62.665   62.654   62.620   62.564   62.486   62.385   62.262   62.117   61.950   61.760
  62.665   62.688   62.756   62.870   63.028   63.230   63.476   63.765   64.095   64.467
```

### 4

IN:
```
-75.24762899442727
54.29322179471416
8.91654183621857
8
310
partial
```

OUT:
```
   0.000    0.003    0.006    0.010    0.013    0.016    0.019    0.023    0.026    0.029
  75.248   75.216   75.123   74.967   74.750   74.470   74.129   73.726   73.263   72.738
   0.000    1.562    3.123    4.681    6.235    7.784    9.327   10.862   12.388   13.904
   0.000   19.304   38.591   57.847   77.055   96.199  115.263  134.232  153.090  171.821
 484.108  483.907  483.306  482.305  480.905  479.106  476.911  474.321  471.338  467.965
 484.108  484.292  484.845  485.762  487.039  488.668  490.642  492.949  495.576  498.511
```

### 5

IN:
```
77.59485233999129
-9.242493630934675
-0.25833849565110434
32
345
partial
```

OUT:
```
   0.000    0.003    0.006    0.009    0.012    0.014    0.017    0.020    0.023    0.026
  77.595   77.595   77.595   77.595   77.595   77.594   77.594   77.594   77.593   77.593
   0.000    0.007    0.014    0.021    0.028    0.035    0.042    0.048    0.055    0.062
   0.000    0.015    0.030    0.045    0.060    0.075    0.090    0.105    0.120    0.135
   2.388    2.388    2.388    2.388    2.388    2.388    2.388    2.388    2.388    2.388
   2.388    2.388    2.388    2.388    2.388    2.389    2.389    2.390    2.391    2.391
```

### 6

IN:
```
-60.081862064827504
3.62287852027859
-9.938308381508374
26
186
partial
```

OUT:
```
   0.000    0.005    0.011    0.016    0.022    0.027    0.032    0.038    0.043    0.048
  60.082   59.996   59.739   59.311   58.714   57.950   57.019   55.926   54.674   53.265
   0.000    0.194    0.386    0.578    0.769    0.957    1.142    1.324    1.502    1.676
   0.000   31.896   63.701   95.324  126.675  157.665  188.204  218.205  247.584  276.256
  36.005   35.954   35.800   35.544   35.186   34.727   34.170   33.515   32.764   31.920
  36.005   48.063   73.072  101.735  131.471  161.444  191.281  220.764  249.743  278.094
```

### 7

IN:
```
-57.71800032738423
-6.730349979994628
6.835438212702577
44
385
full
```

OUT:
```
   0.000    0.003    0.005    0.008    0.010    0.013    0.016    0.018    0.021    0.023
  57.718   57.709   57.682   57.636   57.572   57.491   57.391   57.273   57.137   56.983
   0.000    0.119    0.239    0.358    0.478    0.597    0.716    0.834    0.953    1.071
   0.000    7.005   14.007   21.005   27.996   34.979   41.951   48.909   55.852   62.777
  46.005   45.998   45.976   45.940   45.889   45.824   45.744   45.650   45.542   45.419
  46.005   46.528   48.062   50.514   53.755   57.648   62.068   66.903   72.066   77.484
   0.460    1.379    2.299    3.218    4.135    5.055    5.974    6.894    7.813    8.733
  57.718   57.718   57.717   57.716   57.716   57.717   57.718   57.718   57.718   57.718
   0.688    1.608    2.527    3.447    4.366    5.286    6.206    7.125    8.042    8.962
   6.730    6.730    6.730    6.730    6.730    6.730    6.730    6.730    6.730    6.730
   0.229    1.148    2.068    2.987    3.907    4.826    5.746    6.665    7.582    8.502
 394.514  394.521  394.525  394.527  394.528  394.526  394.523  394.517  394.515  394.521
   0.460    1.379    2.299    3.218    4.135    5.055    5.974    6.894    7.813    8.733
  46.005   46.005   46.004   46.003   46.004   46.004   46.005   46.005   46.005   46.005
   0.229    0.688    1.148    1.608    2.068    2.527    2.987    3.447    3.907    4.366
 394.514  394.518  394.521  394.523  394.525  394.526  394.527  394.528  394.528  394.527
```

### 8

IN:
```
-87.11720439895493
27.717189195324977
9.093942053185323
35
443
full
```

OUT:
```
   0.000    0.002    0.005    0.007    0.009    0.011    0.014    0.016    0.018    0.020
  87.117   87.099   87.044   86.952   86.824   86.659   86.457   86.219   85.945   85.634
   0.000    0.569    1.138    1.706    2.274    2.840    3.405    3.969    4.532    5.092
   0.000   16.263   32.519   48.762   64.984   81.178   97.339  113.458  129.529  145.546
 252.059  252.005  251.846  251.581  251.209  250.732  250.149  249.460  248.667  247.768
 252.059  252.530  253.937  256.263  259.478  263.546  268.420  274.050  280.380  287.355
   0.345    1.036    1.727    2.418    3.109    3.799    4.490    5.181    5.872    6.565
  87.117   87.117   87.117   87.116   87.116   87.115   87.115   87.114   87.113   87.113
   0.174    0.865    1.555    2.246    2.937    3.628    4.319    5.009    5.700    6.391
  27.716   27.716   27.716   27.717   27.717   27.717   27.717   27.717   27.717   27.717
   0.174    0.865    1.555    2.246    2.937    3.628    4.319    5.009    5.700    6.391
 792.199  792.208  792.216  792.223  792.228  792.232  792.236  792.238  792.239  792.239
   0.691    1.382    2.072    2.763    3.454    4.145    4.836    5.526    6.219    6.910
 252.058  252.058  252.057  252.056  252.054  252.052  252.050  252.047  252.046  252.049
   0.174    0.519    0.865    1.210    1.555    1.901    2.246    2.592    2.937    3.282
 792.203  792.208  792.211  792.215  792.218  792.221  792.224  792.227  792.229  792.231
```

### 9

IN:
```
4.17305555312015
32.83963782368937
4.698172312554515
46
226
full
```

OUT:
```
   0.000    0.004    0.009    0.013    0.018    0.022    0.027    0.031    0.035    0.040
   4.173    4.172    4.169    4.165    4.159    4.151    4.141    4.129    4.115    4.100
   0.000    0.683    1.365    2.047    2.728    3.408    4.086    4.762    5.437    6.109
   0.000    0.408    0.815    1.222    1.629    2.034    2.439    2.843    3.246    3.647
 154.286  154.253  154.153  153.986  153.753  153.453  153.087  152.655  152.157  151.593
 154.286  154.253  154.155  153.991  153.762  153.467  153.107  152.682  152.192  151.637
   1.336    2.673    4.014    5.350    6.686    8.023    9.364   10.700   12.037   13.373
   4.173    4.173    4.173    4.173    4.173    4.173    4.173    4.173    4.173    4.173
   0.336    1.673    3.009    4.346    5.682    7.023    8.359    9.696   11.032   12.368
  32.838   32.839   32.840   32.839   32.838   32.839   32.839   32.840   32.839   32.838
   1.005    2.341    3.677    5.014    6.355    7.691    9.027   10.364   11.700   13.041
  19.605   19.606   19.606   19.605   19.605   19.605   19.606   19.606   19.605   19.605
   1.336    2.673    4.014    5.350    6.686    8.023    9.364   10.700   12.037   13.373
 154.285  154.280  154.282  154.286  154.286  154.283  154.278  154.284  154.286  154.285
   0.668    1.336    2.005    2.673    3.345    4.014    4.682    5.350    6.018    6.686
 154.286  154.285  154.283  154.280  154.279  154.282  154.284  154.286  154.286  154.286
```

### 10

IN:
```
48.729132428199165
81.41847250525029
1.3588789676346664
22
157
full
```

OUT:
```
   0.000    0.006    0.013    0.019    0.025    0.032    0.038    0.045    0.051    0.057
  48.729   48.727   48.722   48.713   48.700   48.683   48.663   48.640   48.612   48.581
   0.000    0.705    1.410    2.114    2.819    3.523    4.228    4.931    5.635    6.338
   0.000    0.573    1.147    1.720    2.293    2.866    3.438    4.011    4.583    5.154
 110.638  110.634  110.621  110.601  110.572  110.534  110.489  110.435  110.373  110.302
 110.638  110.635  110.627  110.614  110.595  110.571  110.542  110.508  110.468  110.423
   4.626    9.245   13.870   18.496   22.000    2.313    6.938   11.557   16.183   20.809
  48.729   48.729   48.729   48.729    2.446   48.729   48.729   48.729   48.729   48.729
   1.153    5.779   10.404   15.030   19.649   22.000    3.466    8.092   12.717   17.336
  81.418   81.418   81.418   81.418   81.418   81.316   81.418   81.418   81.418   81.418
   3.466    8.092   12.717   17.336   21.962    1.153    5.779   10.404   15.030   19.649
  66.217   66.217   66.217   66.216   66.217   66.217   66.217   66.217   66.217   66.217
   4.626    9.245   13.870   18.496   22.000    2.313    6.938   11.557   16.183   20.809
 110.638  110.637  110.638  110.638    5.552  110.638  110.637  110.637  110.638  110.638
   2.313    4.626    6.938    9.245   11.557   13.870   16.183   18.496   20.809   22.000
 110.638  110.638  110.637  110.637  110.638  110.638  110.638  110.638  110.638   66.366
```

### 11

IN:
```
-48.55458313443943
87.94751388818054
6.005813886918631
41
415
full
```

OUT:
```
   0.000    0.002    0.005    0.007    0.010    0.012    0.014    0.017    0.019    0.022
  48.555   48.549   48.534   48.509   48.473   48.428   48.372   48.306   48.230   48.143
   0.000    1.273    2.545    3.817    5.089    6.359    7.627    8.895   10.160   11.423
   0.000    4.220    8.440   12.657   16.872   21.083   25.290   29.492   33.688   37.876
 528.196  528.141  527.975  527.699  527.312  526.814  526.206  525.488  524.660  523.722
 528.196  528.158  528.043  527.850  527.581  527.236  526.814  526.315  525.740  525.090
   0.523    1.569    2.615    3.660    4.709    5.755    6.800    7.846    8.892    9.938
  48.555   48.554   48.554   48.553   48.554   48.554   48.555   48.555   48.554   48.554
   0.263    1.309    2.354    3.400    4.446    5.492    6.538    7.586    8.632    9.678
  87.946   87.947   87.947   87.947   87.947   87.947   87.946   87.945   87.946   87.947
   0.263    1.309    2.354    3.400    4.446    5.492    6.538    7.586    8.632    9.678
 291.603  291.607  291.609  291.610  291.609  291.608  291.605  291.603  291.606  291.609
   1.046    2.092    3.138    4.186    5.232    6.277    7.323    8.369    9.415   10.461
 528.195  528.192  528.187  528.186  528.192  528.195  528.196  528.196  528.192  528.187
   0.523    1.046    1.569    2.092    2.615    3.138    3.660    4.186    4.709    5.232
 528.196  528.196  528.195  528.193  528.192  528.190  528.187  528.189  528.191  528.193
```

## Solution

```py
def sample_time_interval(t_max, samples_per_second):
  return np.linspace(0, t_max, samples_per_second * t_max)

def x_coord(a, b, omega, samples):
  return a * np.cos(samples * omega)

def y_coord(a, b, omega, samples):
  return b * np.sin(samples * omega)

def x_speed(a, b, omega, samples):
  return -a * omega * np.sin(samples * omega)

def y_speed(a, b, omega, samples):
  return b * omega * np.cos(samples * omega)

def speed(v_x, v_y):
  return np.sqrt(v_x**2 + v_y**2)

def stationary_points(samples, values):
  delta_values = values[1:] - values[:-1]
  delta_samples = samples[1:] - samples[:-1]

  derivatives = delta_values / delta_samples

  increasing_samples = np.nonzero(derivatives >= 0)[0]
  decreasing_samples = np.nonzero(derivatives < 0)[0]

  stationary_samples = []
  stationary_values = []

  for k in range(len(increasing_samples)):
    if (increasing_samples[k]-1) in increasing_samples and (increasing_samples[k]+1) not in increasing_samples:
      pos = increasing_samples[k]
      stationary_samples.append(samples[pos + 1])
      stationary_values.append(values[pos + 1])

  for k in range(len(decreasing_samples)):
    if (decreasing_samples[k]-1) in decreasing_samples and (decreasing_samples[k]+1) not in decreasing_samples:
      pos = decreasing_samples[k]
      stationary_samples.append(samples[pos + 1])
      stationary_values.append(values[pos + 1])

  return np.array(stationary_samples), np.array(stationary_values)
```
